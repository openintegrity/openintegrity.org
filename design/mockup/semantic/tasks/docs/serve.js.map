{"version":3,"sources":["../../../../../../../content/design/mockup/semantic/tasks/docs/serve.js"],"names":[],"mappings":"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","file":"serve.js","sourcesContent":["/*******************************\n           Serve Docs\n*******************************/\nvar\n  gulp         = require('gulp'),\n\n  // node dependencies\n  console      = require('better-console'),\n  fs           = require('fs'),\n\n  // gulp dependencies\n  autoprefixer = require('gulp-autoprefixer'),\n  chmod        = require('gulp-chmod'),\n  clone        = require('gulp-clone'),\n  gulpif       = require('gulp-if'),\n  header       = require('gulp-header'),\n  less         = require('gulp-less'),\n  minifyCSS    = require('gulp-minify-css'),\n  plumber      = require('gulp-plumber'),\n  print        = require('gulp-print'),\n  rename       = require('gulp-rename'),\n  replace      = require('gulp-replace'),\n  uglify       = require('gulp-uglify'),\n  util         = require('gulp-util'),\n  watch        = require('gulp-watch'),\n\n  // user config\n  config       = require('../config/docs'),\n\n  // task config\n  tasks        = require('../config/tasks'),\n  configSetup  = require('../config/project/config'),\n  install      = require('../config/project/install'),\n\n  // shorthand\n  banner       = tasks.banner,\n  comments     = tasks.regExp.comments,\n  log          = tasks.log,\n  settings     = tasks.settings,\n\n  globs,\n  assets,\n  output,\n  source\n;\n\nrequire('../collections/internal')(gulp);\n\nmodule.exports = function () {\n\n  // use a different config\n  config = configSetup.addDerivedValues(config);\n\n  // shorthand\n  globs  = config.globs;\n  assets = config.paths.assets;\n  output = config.paths.output;\n  source = config.paths.source;\n\n\n  /*--------------\n     Copy Source\n  ---------------*/\n\n  gulp\n    .watch([\n      'src/**/*.*'\n    ], function(file) {\n      console.clear();\n      return gulp.src(file.path, {\n          base: 'src/'\n        })\n        .pipe(gulp.dest(output.less))\n        .pipe(print(log.created))\n      ;\n    })\n  ;\n\n  /*--------------\n    Copy Examples\n  ---------------*/\n\n  gulp\n    .watch([\n      'examples/**/*.*'\n    ], function(file) {\n      console.clear();\n      return gulp.src(file.path, {\n          base: 'examples/'\n        })\n        .pipe(gulp.dest(output.examples))\n        .pipe(print(log.created))\n      ;\n    })\n  ;\n\n  /*--------------\n      Watch CSS\n  ---------------*/\n\n  gulp\n    .watch([\n      source.config,\n      source.definitions   + '/**/*.less',\n      source.site          + '/**/*.{overrides,variables}',\n      source.themes        + '/**/*.{overrides,variables}'\n    ], function(file) {\n\n      var\n        lessPath,\n\n        stream,\n        compressedStream,\n        uncompressedStream,\n\n        isDefinition,\n        isPackagedTheme,\n        isSiteTheme,\n        isConfig\n      ;\n\n      // log modified file\n      gulp.src(file.path)\n        .pipe(print(log.modified))\n      ;\n\n      /*--------------\n         Find Source\n      ---------------*/\n\n      // recompile on *.override , *.variable change\n      isConfig        = (file.path.indexOf('theme.config') !== -1 || file.path.indexOf('site.variables') !== -1);\n      isPackagedTheme = (file.path.indexOf(source.themes) !== -1);\n      isSiteTheme     = (file.path.indexOf(source.site) !== -1);\n      isDefinition    = (file.path.indexOf(source.definitions) !== -1);\n\n      if(isConfig) {\n        // console.info('Rebuilding all files');\n        // cant rebuild paths are wrong\n        // gulp.start('build-docs');\n        return;\n      }\n      else if(isPackagedTheme) {\n        console.log('Change detected in packaged theme');\n        lessPath = util.replaceExtension(file.path, '.less');\n        lessPath = lessPath.replace(tasks.regExp.theme, source.definitions);\n      }\n      else if(isSiteTheme) {\n        console.log('Change detected in site theme');\n        lessPath = util.replaceExtension(file.path, '.less');\n        lessPath = lessPath.replace(source.site, source.definitions);\n      }\n      else {\n        console.log('Change detected in definition');\n        lessPath = file.path;\n      }\n\n      /*--------------\n        Create CSS\n      ---------------*/\n\n      if( fs.existsSync(lessPath) ) {\n\n        // unified css stream\n        stream = gulp.src(lessPath)\n          .pipe(plumber())\n          .pipe(less(settings.less))\n          .pipe(replace(comments.variables.in, comments.variables.out))\n          .pipe(replace(comments.large.in, comments.large.out))\n          .pipe(replace(comments.small.in, comments.small.out))\n          .pipe(replace(comments.tiny.in, comments.tiny.out))\n          .pipe(autoprefixer(settings.prefix))\n          .pipe(gulpif(config.hasPermission, chmod(config.permission)))\n        ;\n\n        // use 2 concurrent streams from same pipe\n        uncompressedStream = stream.pipe(clone());\n        compressedStream   = stream.pipe(clone());\n\n        uncompressedStream\n          .pipe(plumber())\n          .pipe(replace(assets.source, assets.uncompressed))\n          .pipe(header(banner, settings.header))\n          .pipe(gulp.dest(output.uncompressed))\n          .pipe(print(log.created))\n          .on('end', function() {\n            gulp.start('package uncompressed docs css');\n          })\n        ;\n\n        compressedStream = stream\n          .pipe(plumber())\n          .pipe(replace(assets.source, assets.compressed))\n          .pipe(minifyCSS(settings.minify))\n          .pipe(rename(settings.rename.minCSS))\n          .pipe(header(banner, settings.header))\n          .pipe(gulp.dest(output.compressed))\n          .pipe(print(log.created))\n          .on('end', function() {\n            gulp.start('package compressed docs css');\n          })\n        ;\n\n      }\n      else {\n        console.log('Cannot find UI definition at path', lessPath);\n      }\n    })\n  ;\n\n  /*--------------\n      Watch JS\n  ---------------*/\n\n  gulp\n    .watch([\n      source.definitions   + '/**/*.js'\n    ], function(file) {\n      gulp.src(file.path)\n        .pipe(plumber())\n        .pipe(gulpif(config.hasPermission, chmod(config.permission)))\n        .pipe(gulp.dest(output.uncompressed))\n        .pipe(print(log.created))\n        .pipe(uglify(settings.uglify))\n        .pipe(rename(settings.rename.minJS))\n        .pipe(gulp.dest(output.compressed))\n        .pipe(print(log.created))\n        .on('end', function() {\n          gulp.start('package compressed docs js');\n          gulp.start('package uncompressed docs js');\n        })\n      ;\n    })\n  ;\n\n  /*--------------\n    Watch Assets\n  ---------------*/\n\n  // only copy assets that match component names (or their plural)\n  gulp\n    .watch([\n      source.themes   + '/**/assets/**/' + globs.components + '?(s).*'\n    ], function(file) {\n      // copy assets\n      gulp.src(file.path, { base: source.themes })\n        .pipe(gulpif(config.hasPermission, chmod(config.permission)))\n        .pipe(gulp.dest(output.themes))\n        .pipe(print(log.created))\n      ;\n    })\n  ;\n\n\n};"]}